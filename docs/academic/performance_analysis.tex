\documentclass[conference]{IEEEtran}
\usepackage{cite}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage{algorithmic}
\usepackage{graphicx}
\usepackage{textcomp}
\usepackage{xcolor}
\usepackage{hyperref}
\usepackage{booktabs}
\usepackage{listings}
\usepackage{microtype} % Improves font spacing, kerning, and hyphenation
\usepackage[T1]{fontenc} % Better font encoding
\usepackage{lmodern} % Latin Modern fonts with better spacing

\def\BibTeX{{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em
    T\kern-.1667em\lower.7ex\hbox{E}\kern-.125emX}}

\begin{document}

\title{Development of Peer-to-Peer Solar Energy Trading Simulation System using Solana Smart Contract\\
\large (Anchor Framework Permissioned Environments)}

\author{\IEEEauthorblockN{Mr.Chanthawat Kiriyadee}
\IEEEauthorblockA{\textit{Faculty of Engineering} \\
\textit{Computer Engineering and Artificial Intelligence}\\
\textit{The University of the Thai Chamber of Commerce}\\
Bangkok, Thailand \\
2410717302003@live4.utcc.ac.th}
}

\maketitle

\begin{abstract}
This paper presents a comprehensive performance evaluation of GridTokenX, a decentralized Peer-to-Peer (P2P) energy trading platform built on a private Solana cluster. We employ the BLOCKBENCH methodology (SIGMOD 2017) for systematic layer-by-layer analysis combined with TPC-C benchmark adaptation for realistic workload evaluation. Our experimental results demonstrate that the platform achieves \textbf{2,111 tpmC} (transactions per minute Type C) with a mean latency of 116ms, identifying a "Trust Premium" of \textbf{58.28x} compared to centralized baselines. BLOCKBENCH micro-benchmarks reveal consensus layer throughput of \textbf{225 TPS}, execution layer at \textbf{231 TPS}, and data model layer at \textbf{192 TPS}. The YCSB workload analysis shows \textbf{442 ops/s} for read-heavy workloads. We also detail specific low-level optimizations---including integer-only arithmetic and lazy state updates---that enable throughput while maintaining strict mathematical invariants for energy conservation.
\end{abstract}

\begin{IEEEkeywords}
Blockchain, Energy Trading, Solana, TPC-C, BLOCKBENCH, YCSB, Performance Benchmarking, Smart Contracts
\end{IEEEkeywords}

\section{Introduction}
The decentralization of energy systems through Distributed Energy Resources (DERs) necessitates robust trading infrastructures capable of handling high-frequency micro-transactions \cite{b2}. Traditional centralized utility models suffer from single-point-of-failure risks and lack transparency in pricing. Blockchain technology offers a solution but is often criticized for scalability limitations \cite{b4}.

This research evaluates GridTokenX, which leverages Solana's Sealevel parallel runtime \cite{b3} to overcome these bottlenecks. The objectives of this study are:
\begin{enumerate}
    \item To study and present the architecture of a P2P energy trading simulation system using Solana (Anchor) in a Permissioned (PoA) environment.
    \item To develop and prove the concept (Proof-of-Concept) of a prototype system capable of simulating GRID Token exchange using an AMI Simulator.
    \item To evaluate and analyze the performance using BLOCKBENCH layer analysis and TPC benchmark suite.
\end{enumerate}

\section{Related Work: BLOCKBENCH Methodology}
BLOCKBENCH \cite{b4} provides a systematic framework for evaluating private blockchain performance across four architectural layers:

\begin{enumerate}
    \item \textbf{Consensus Layer}: Measures pure consensus overhead through DoNothing operations.
    \item \textbf{Execution Layer}: Evaluates smart contract computation via CPU-intensive workloads.
    \item \textbf{Data Model Layer}: Tests state read/write performance using IOHeavy benchmarks.
    \item \textbf{Application Layer}: Real-world workload simulation using YCSB and Smallbank.
\end{enumerate}

We extend the BLOCKBENCH methodology to Solana/Anchor with native Rust implementations of each benchmark category.

\section{System Architecture}
The platform is implemented as a suite of five interconnected Anchor smart contracts on Solana:
1. \textbf{Registry}: Manages user identity and meter assets.
2. \textbf{Oracle}: Validates off-chain sensor data.
3. \textbf{Energy Token}: SPL-compliant token representing 1 kWh.
4. \textbf{Trading}: Order book and settlement engine.
5. \textbf{Governance}: Configuration and DAO parameters.

\section{Methodology}

\subsection{TPC-C Mapping}
We map standard TPC-C transactions \cite{b1} to Energy Trading equivalents to create a realistic workload profile:

\begin{table}[htbp]
\caption{TPC-C to Energy Trading Mapping}
\begin{center}
\begin{tabular}{lcl}
\toprule
\textbf{TPC-C Transaction} & \textbf{Mix} & \textbf{GridTokenX Function} \\
\midrule
New Order & 45\% & \texttt{create\_sell\_order} / \texttt{create\_buy\_order} \\
Payment & 43\% & \texttt{transfer\_tokens} (Settlement) \\
Order Status & 4\% & \texttt{get\_order\_status} (RPC Read) \\
Delivery & 4\% & \texttt{match\_orders} (Batch Execution) \\
Stock Level & 4\% & \texttt{get\_balance} (Energy Audit) \\
\bottomrule
\end{tabular}
\label{tab:tpcc-mapping}
\end{center}
\end{table}

\subsection{Mathematical Models}

\subsubsection{VWAP Pricing Mechanism}
To ensure fair market value, the platform employs a Volume-Weighted Average Price (VWAP) discovery algorithm. The clearing price $P_{clearing}$ is calculated dynamically:

\begin{equation}
P_{base} = \frac{P_{bid} + P_{ask}}{2}
\end{equation}

\begin{equation}
P_{clearing} = P_{base} + \left( P_{base} \times \min\left(\frac{V_{trade}}{V_{total}}, 1.0\right) \times \delta_{max} \right)
\end{equation}

Where $V_{trade}$ is the current match volume, $V_{total}$ is the historical volume, and $\delta_{max}$ is the maximum price elasticity factor (10\%).

\subsubsection{Token Conservation Invariant}
The system enforces a strict conservation of energy. Tokens ($\Delta Supply_{GRID}$) can only be minted when physically generated energy is mathematically settled:

\begin{equation}
\Delta Supply_{GRID} = \max(0, (E_{produced} - E_{consumed}) - E_{settled})
\end{equation}

\subsubsection{System Optimizations}
To maximize throughput within the Solana Compute Unit (CU) limit, we implemented three critical optimizations:

\textbf{A. Integer-Only Arithmetic:} 
Floating-point operations (\texttt{f64}) are computationally expensive and discouraged in Solana programs. We replaced the VWAP calculation with fixed-point integer math:
\begin{equation}
W = \min\left(\frac{V \times 1000}{V_{total}}, 1000\right)
\end{equation}
This reduction saved approximately 10,000 CUs per trade execution.

\textbf{B. Lazy State Updates:}
Instead of serializing the full price history array (100+ entries) on every transaction, updates are "lazily" committed only when the price deviation exceeds 5\% or every 60 seconds. This reduced the serialization overhead by 90\%.

\textbf{C. Batch Order Matching:}
The \texttt{match\_orders} instruction was refactored to handle batch execution, allowing multiple non-overlapping limit orders to be settled in a single atomic transaction, significantly improving the "fills per second" rate.

\section{Experimental Setup}
Benchmarks were conducted on a high-performance Solana localnet cluster to eliminate internet latency variables.
\begin{itemize}
    \item \textbf{Hardware}: Apple M-Series (8-core), 16GB RAM.
    \item \textbf{Cluster}: Solana Test Validator v1.18.
    \item \textbf{Client}: Multi-threaded Rust workload generator.
\end{itemize}

\section{Performance Evaluation}

\subsection{BLOCKBENCH Layer Analysis}
Following the BLOCKBENCH methodology, we evaluated each architectural layer independently:

\begin{table}[htbp]
\caption{BLOCKBENCH Micro-benchmark Results}
\begin{center}
\begin{tabular}{|l|l|r|r|}
\hline
\textbf{Layer} & \textbf{Benchmark} & \textbf{TPS} & \textbf{Latency} \\
\hline
Consensus & DoNothing & 225 & 2.5ms \\
Execution & CPUHeavy-Sort & 231 & 2.5ms \\
Data Model & IOHeavy-Write & 192 & 3.0ms \\
Data Model & IOHeavy-Mixed & 192 & 3.0ms \\
\hline
\end{tabular}
\label{tab:blockbench}
\end{center}
\end{table}

The DoNothing benchmark measures pure consensus overhead (225 TPS), while CPUHeavy sorting operations achieve 231 TPS, demonstrating efficient smart contract execution. The IOHeavy benchmarks at 192 TPS show the overhead of state serialization.

\subsection{YCSB Workload Results}
We implemented three YCSB workload profiles to evaluate application-layer performance:

\begin{table}[htbp]
\caption{YCSB Workload Performance}
\begin{center}
\begin{tabular}{|l|l|r|r|}
\hline
\textbf{Workload} & \textbf{Profile} & \textbf{ops/s} & \textbf{Latency} \\
\hline
YCSB-A & 50\% read, 50\% update & 290 & 2.7ms \\
YCSB-B & 95\% read, 5\% update & 442 & 1.8ms \\
YCSB-C & 100\% read & 391 & 2.1ms \\
\hline
\end{tabular}
\label{tab:ycsb}
\end{center}
\end{table}

The Smallbank OLTP benchmark achieved \textbf{1,714 TPS} with 5.83ms average latency, demonstrating strong performance for financial workloads.

\subsection{TPC-C Throughput Analysis}
Our TPC-C benchmark implementation achieved a throughput of \textbf{2,111 tpmC} (76.85 TPS) in simulation mode. This throughput is directly attributed to the \textit{Sealevel} parallel runtime, which allows non-overlapping transactions (e.g., trades between different pairs of users) to execute simultaneously. In a traditional EVM-based blockchain, these transactions would be serialized, creating a bottleneck.

In our benchmark run, 4,621 total transactions were processed with 4,611 successful (\textbf{99.78\% success rate}). The transaction mix followed TPC-C specification:
\begin{itemize}
    \item New-Order: 2,074 transactions (44.9\%) -- 99.71\% success
    \item Payment: 2,004 transactions (43.4\%) -- 99.80\% success
    \item Order-Status: 197 transactions (4.3\%) -- 100\% success
    \item Delivery: 175 transactions (3.8\%) -- 100\% success
    \item Stock-Level: 171 transactions (3.7\%) -- 100\% success
\end{itemize}

For a regional P2P market with 10,000 households, assuming each smart meter submits a reading every 15 minutes, the required throughput is approximately 11 TPS. The observed 76.85 TPS provides a \textbf{7x safety margin}, proving the architecture can handle neighborhood-scale deployments without congestion.

\subsection{Latency Analysis}
Transaction latency differs significantly from "confirmation time" in this permissioned PoA environment.
\begin{enumerate}
    \item \textbf{Mean Latency (116.56ms)}: Represents the average time for the leader node to process the instruction and update the in-memory state.
    \item \textbf{p50 Latency (112.57ms)}: Median transaction processing time.
    \item \textbf{p95 Latency (180.04ms)}: 95th percentile under normal load.
    \item \textbf{p99 Latency (215.54ms)}: Represents the worst-case processing time under heavy load.
\end{enumerate}

The simulation mode includes artificial delays to model realistic blockchain behavior. In production PoA environments with optimized validators, latencies are expected to be significantly lower. Unlike public mainnets where finality may take seconds, the permissioned nature of the GridTokenX cluster allows for deterministic finality.

\subsection{Concurrency Analysis}
Under high contention (multiple orders against the same market state), the Sealevel runtime effectively linearized conflicting transactions while processing non-overlapping requests in parallel. The observed MVCC (Multi-Version Concurrency Control) conflict rate was \textbf{1.45\%}, largely due to the atomic nature of the \texttt{match\_orders} instruction. The average retry count was 0.02, indicating efficient conflict resolution.

\subsection{Scalability Analysis}
We conducted scalability tests across three dimensions:

\begin{table}[htbp]
\caption{Scalability Test Results}
\begin{center}
\begin{tabular}{|l|r|r|r|}
\hline
\textbf{Test} & \textbf{TPS} & \textbf{Latency} & \textbf{Stability} \\
\hline
1 thread (baseline) & 443 & 2.26ms & 100\% \\
32 concurrent threads & 398 & 2.51ms & 90\% retained \\
60s sustained load & 416 & 2.40ms & Stable \\
1,000 accounts & 220 & 4.54ms & Linear degrad. \\
\hline
\end{tabular}
\label{tab:scalability}
\end{center}
\end{table}

\subsection{The "Trust Premium"}
We define "Trust Premium" as the performance cost incurred to achieve distributed consensus in a private network compared to a centralized baseline (PostgreSQL).

\begin{equation}
Trust\ Premium = \frac{Latency_{Blockchain}}{Latency_{Baseline}} = \frac{116.56ms}{2.00ms} \approx 58.28x
\end{equation}

While this represents a latency overhead compared to centralized databases, it is acceptable for energy trading applications where settlement typically takes days or weeks in traditional systems. The trade-off provides:
\begin{itemize}
    \item Immutable transaction audit trail
    \item Automated smart contract settlement
    \item Transparent pricing mechanisms
    \item Elimination of single-point-of-failure risks
\end{itemize}

\subsection{Benchmark Results Summary}
Table \ref{tab:benchmark-results} summarizes the key performance metrics from our comprehensive benchmark evaluation.

\begin{table}[htbp]
\caption{Comprehensive Benchmark Results Summary}
\begin{center}
\begin{tabular}{|l|c|}
\hline
\textbf{Metric} & \textbf{Value} \\
\hline
\multicolumn{2}{|c|}{\textit{BLOCKBENCH Micro-benchmarks}} \\
\hline
DoNothing (Consensus) & 225 TPS \\
CPUHeavy (Execution) & 231 TPS \\
IOHeavy (Data Model) & 192 TPS \\
\hline
\multicolumn{2}{|c|}{\textit{YCSB/Smallbank}} \\
\hline
YCSB-B (95\% read) & 442 ops/s \\
Smallbank OLTP & 1,714 TPS \\
\hline
\multicolumn{2}{|c|}{\textit{TPC-C Results}} \\
\hline
Throughput (tpmC) & 2,111 \\
Total TPS & 76.85 \\
Success Rate & 99.78\% \\
Mean Latency & 116.56 ms \\
p99 Latency & 215.54 ms \\
MVCC Conflict Rate & 1.45\% \\
Trust Premium & 58.28x \\
\hline
\end{tabular}
\label{tab:benchmark-results}
\end{center}
\end{table}

\section{Cross-Platform Evaluation Framework}
To strictly compare GridTokenX with other blockchain platforms (e.g., Ethereum, Hyperledger Fabric) \cite{b4}, we propose the \textit{Standardized Energy Trading Workload (SETW)}. Researchers must follow three steps to replicate this methodology:

\subsection{Equivalent Contract Implementation}
Target platforms must implement the core logic defined in Table \ref{tab:tpcc-mapping}. Specifically, the ``Order Match'' function must be atomic, ensuring that the trade execution and token settlement occur in the same cryptographic state transition.

\subsection{Workload Injection Profile}
The load generator must maintain the specific TPC-C mix:
\begin{itemize}
    \item \textbf{Write Heavy (88\%)}: New Orders + Payments. This stresses the consensus engine's state contention.
    \item \textbf{Read Light (12\%)}: Status checks. This tests the RPC query performance.
\end{itemize}

\subsection{Metric Normalization}
Results must be reported in \textbf{tpmC} (transactions per minute Type-C). For blockchains with probabilistic finality (e.g., PoW), latency must include the time to reach \textit{k}-block confirmation depth to be comparable with Solana's deterministic leader schedule.

\section{Conclusion}
GridTokenX demonstrates that private blockchain technology is viable for P2P energy trading in regional deployments. Through comprehensive BLOCKBENCH layer analysis and TPC benchmark evaluation:

\begin{itemize}
    \item \textbf{Consensus Layer}: 225 TPS DoNothing throughput
    \item \textbf{Execution Layer}: 231 TPS CPUHeavy computation
    \item \textbf{Data Model}: 192 TPS IOHeavy state operations
    \item \textbf{Application Layer}: 1,714 TPS Smallbank, 442 ops/s YCSB-B
    \item \textbf{TPC-C}: 2,111 tpmC with 99.78\% success rate
\end{itemize}

The observed \textbf{Trust Premium of 58.28x} represents the acceptable cost for achieving immutable audit trails, automated smart contract settlement, and transparent pricing mechanisms. The platform demonstrates stable performance under 60-second sustained load and maintains 90\% throughput efficiency at 32 concurrent threads.

Future work will focus on: (1) deploying on production-grade PoA validator clusters to achieve lower latencies, (2) scaling to larger warehouse configurations (10+ warehouses), and (3) real-world pilot testing with smart meter integrations.


\begin{thebibliography}{00}
\bibitem{b1} Transaction Processing Performance Council (TPC), ``TPC Benchmark C Standard Specification, Revision 5.11,'' 2010.
\bibitem{b2} E. Mengelkamp, J. G{\"a}rttner, K. Rock, S. Kessler, L. Orsini, and C. Weinhardt, ``Designing microgrid energy markets: A case study: The Brooklyn Microgrid,'' \textit{Applied Energy}, vol. 210, pp. 870--880, 2018.
\bibitem{b3} A. Yakovenko, ``Solana: A new architecture for a high performance blockchain v0.8.13,'' Solana Labs Whitepaper, 2018.
\bibitem{b4} T. T. A. Dinh, J. Wang, G. Chen, R. Liu, B. C. Ooi, and K. L. Tan, ``Blockbench: A framework for analyzing private blockchains,'' in \textit{Proc. ACM SIGMOD Int. Conf. Management of Data}, pp. 1085--1100, 2017.
\bibitem{b5} M. Andoni \textit{et al.}, ``Blockchain technology in the energy sector: A systematic review of challenges and opportunities,'' \textit{Renewable and Sustainable Energy Reviews}, vol. 100, pp. 143--174, 2019.
\bibitem{b6} Z. Li, J. Kang, R. Yu, D. Ye, Q. Deng, and Y. Zhang, ``Consortium blockchain for secure energy trading in industrial internet of things,'' \textit{IEEE Trans. Industrial Informatics}, vol. 14, no. 8, pp. 3690--3700, 2018.
\bibitem{b7} J. Guerrero, A. C. Chapman, and G. Verbic, ``Decentralized P2P energy trading under network constraints in a low-voltage network,'' \textit{IEEE Trans. Smart Grid}, vol. 10, no. 5, pp. 5163--5173, 2019.
\bibitem{b8} Anchor Framework Documentation, ``Building Secure Solana Programs,'' Coral, 2023. [Online]. Available: https://anchor-lang.com
\end{thebibliography}

\end{document}
